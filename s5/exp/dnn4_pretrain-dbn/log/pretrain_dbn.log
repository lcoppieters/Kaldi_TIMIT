# Running on vgnd012
# Started at Tue Oct 20 10:22:05 CEST 2020
# steps/nnet/pretrain_dbn.sh --hid-dim 1024 --rbm-iter 20 data-fmllr-tri3/train exp/dnn4_pretrain-dbn 
steps/nnet/pretrain_dbn.sh --hid-dim 1024 --rbm-iter 20 data-fmllr-tri3/train exp/dnn4_pretrain-dbn
# INFO
steps/nnet/pretrain_dbn.sh : Pre-training Deep Belief Network as a stack of RBMs
	 dir       : exp/dnn4_pretrain-dbn 
	 Train-set : data-fmllr-tri3/train '3696'

LOG ([5.5.810~1-76a979]:main():cuda-gpu-available.cc:61) 

### IS CUDA GPU AVAILABLE? 'vgnd012' ###
WARNING ([5.5.810~1-76a979]:SelectGpuId():cu-device.cc:228) Not in compute-exclusive mode.  Suggestion: use 'nvidia-smi -c 3' to set compute exclusive mode
LOG ([5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:408) Selecting from 1 GPUs
LOG ([5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:423) cudaSetDevice(0): Tesla K80	free:11372M, used:68M, total:11441M, free/total:0.993991
LOG ([5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:471) Device: 0, mem_ratio: 0.993991
LOG ([5.5.810~1-76a979]:SelectGpuId():cu-device.cc:352) Trying to select device: 0
LOG ([5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:481) Success selecting device 0 free mem ratio: 0.993991
LOG ([5.5.810~1-76a979]:FinalizeActiveGpu():cu-device.cc:308) The active GPU is [0]: Tesla K80	free:11262M, used:178M, total:11441M, free/total:0.984377 version 3.7
### HURRAY, WE GOT A CUDA GPU FOR COMPUTATION!!! ##

### Testing CUDA setup with a small computation (setup = cuda-toolkit + gpu-driver + kaldi):
### Test OK!

# PREPARING FEATURES
copy-feats --compress=true scp:data-fmllr-tri3/train/feats.scp ark,scp:/tmp/kaldi.b1S4/train.ark,exp/dnn4_pretrain-dbn/train_sorted.scp 
LOG (copy-feats[5.5.810~1-76a979]:main():copy-feats.cc:143) Copied 3696 feature matrices.
# 'apply-cmvn' not used,
feat-to-dim 'ark:copy-feats scp:exp/dnn4_pretrain-dbn/train.scp ark:- |' - 
copy-feats scp:exp/dnn4_pretrain-dbn/train.scp ark:- 
WARNING (feat-to-dim[5.5.810~1-76a979]:Close():kaldi-io.cc:515) Pipe copy-feats scp:exp/dnn4_pretrain-dbn/train.scp ark:- | had nonzero return status 36096
# feature dim : 40 (input of 'feature_transform')
+ default 'feature_transform_proto' with splice +/-5 frames
nnet-initialize --binary=false exp/dnn4_pretrain-dbn/splice5.proto exp/dnn4_pretrain-dbn/tr_splice5.nnet 
VLOG[1] (nnet-initialize[5.5.810~1-76a979]:Init():nnet-nnet.cc:314) <Splice> <InputDim> 40 <OutputDim> 440 <BuildVector> -5:5 </BuildVector>
LOG (nnet-initialize[5.5.810~1-76a979]:main():nnet-initialize.cc:63) Written initialized model to exp/dnn4_pretrain-dbn/tr_splice5.nnet
# compute normalization stats from 10k sentences
compute-cmvn-stats ark:- exp/dnn4_pretrain-dbn/cmvn-g.stats 
nnet-forward --print-args=true --use-gpu=yes exp/dnn4_pretrain-dbn/tr_splice5.nnet 'ark:copy-feats scp:exp/dnn4_pretrain-dbn/train.scp.10k ark:- |' ark:- 
WARNING (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:228) Not in compute-exclusive mode.  Suggestion: use 'nvidia-smi -c 3' to set compute exclusive mode
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:408) Selecting from 1 GPUs
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:423) cudaSetDevice(0): Tesla K80	free:11372M, used:68M, total:11441M, free/total:0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:471) Device: 0, mem_ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:352) Trying to select device: 0
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:481) Success selecting device 0 free mem ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:FinalizeActiveGpu():cu-device.cc:308) The active GPU is [0]: Tesla K80	free:11262M, used:178M, total:11441M, free/total:0.984377 version 3.7
copy-feats scp:exp/dnn4_pretrain-dbn/train.scp.10k ark:- 
LOG (copy-feats[5.5.810~1-76a979]:main():copy-feats.cc:143) Copied 3696 feature matrices.
LOG (nnet-forward[5.5.810~1-76a979]:main():nnet-forward.cc:192) Done 3696 files in 0.104629min, (fps 179176)
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:168) Wrote global CMVN stats to exp/dnn4_pretrain-dbn/cmvn-g.stats
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:171) Done accumulating CMVN stats for 3696 utterances; 0 had errors.
# + normalization of NN-input at 'exp/dnn4_pretrain-dbn/tr_splice5_cmvn-g.nnet'
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/tr_splice5.nnet
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating cmvn-to-nnet exp/dnn4_pretrain-dbn/cmvn-g.stats -|
cmvn-to-nnet exp/dnn4_pretrain-dbn/cmvn-g.stats - 
LOG (cmvn-to-nnet[5.5.810~1-76a979]:main():cmvn-to-nnet.cc:114) Written cmvn in 'nnet1' model to: -
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn/tr_splice5_cmvn-g.nnet

### Showing the final 'feature_transform':
nnet-info exp/dnn4_pretrain-dbn/tr_splice5_cmvn-g.nnet 
num-components 3
input-dim 40
output-dim 440
number-of-parameters 0.00088 millions
component 1 : <Splice>, input-dim 40, output-dim 440, 
  frame_offsets [ -5 -4 -3 -2 -1 0 1 2 3 4 5 ]
component 2 : <AddShift>, input-dim 440, output-dim 440, 
  shift_data ( min -0.115547, max 0.175501, mean -0.00607088, stddev 0.0387011, skewness 1.43335, kurtosis 9.0895 ) , lr-coef 0
component 3 : <Rescale>, input-dim 440, output-dim 440, 
  scale_data ( min 0.317607, max 0.968554, mean 0.764179, stddev 0.156348, skewness -0.661368, kurtosis -0.181612 ) , lr-coef 0
LOG (nnet-info[5.5.810~1-76a979]:main():nnet-info.cc:57) Printed info about exp/dnn4_pretrain-dbn/tr_splice5_cmvn-g.nnet
###

# PRE-TRAINING RBM LAYER 1
# initializing 'exp/dnn4_pretrain-dbn/1.rbm.init'
# pretraining 'exp/dnn4_pretrain-dbn/1.rbm' (input gauss, lrate 0.01, iters 40)
# converting RBM to exp/dnn4_pretrain-dbn/1.dbn
rbm-convert-to-nnet exp/dnn4_pretrain-dbn/1.rbm exp/dnn4_pretrain-dbn/1.dbn 
LOG (rbm-convert-to-nnet[5.5.810~1-76a979]:main():rbm-convert-to-nnet.cc:69) Written model to exp/dnn4_pretrain-dbn/1.dbn

# PRE-TRAINING RBM LAYER 2
# computing cmvn stats 'exp/dnn4_pretrain-dbn/2.cmvn' for RBM initialization
WARNING (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:228) Not in compute-exclusive mode.  Suggestion: use 'nvidia-smi -c 3' to set compute exclusive mode
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:408) Selecting from 1 GPUs
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:423) cudaSetDevice(0): Tesla K80	free:11372M, used:68M, total:11441M, free/total:0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:471) Device: 0, mem_ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:352) Trying to select device: 0
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:481) Success selecting device 0 free mem ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:FinalizeActiveGpu():cu-device.cc:308) The active GPU is [0]: Tesla K80	free:11262M, used:178M, total:11441M, free/total:0.984377 version 3.7
nnet-concat exp/dnn4_pretrain-dbn/final.feature_transform exp/dnn4_pretrain-dbn/1.dbn - 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/final.feature_transform
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn/1.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to -
copy-feats scp:exp/dnn4_pretrain-dbn/train.scp.10k ark:- 
LOG (copy-feats[5.5.810~1-76a979]:main():copy-feats.cc:143) Copied 3696 feature matrices.
LOG (nnet-forward[5.5.810~1-76a979]:main():nnet-forward.cc:192) Done 3696 files in 0.309713min, (fps 60530.4)
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:168) Wrote global CMVN stats to standard output
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:171) Done accumulating CMVN stats for 3696 utterances; 0 had errors.
LOG (cmvn-to-nnet[5.5.810~1-76a979]:main():cmvn-to-nnet.cc:114) Written cmvn in 'nnet1' model to: exp/dnn4_pretrain-dbn/2.cmvn
initializing 'exp/dnn4_pretrain-dbn/2.rbm.init'
pretraining 'exp/dnn4_pretrain-dbn/2.rbm' (lrate 0.4, iters 20)
# appending RBM to exp/dnn4_pretrain-dbn/2.dbn
nnet-concat exp/dnn4_pretrain-dbn/1.dbn 'rbm-convert-to-nnet exp/dnn4_pretrain-dbn/2.rbm - |' exp/dnn4_pretrain-dbn/2.dbn 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/1.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating rbm-convert-to-nnet exp/dnn4_pretrain-dbn/2.rbm - |
rbm-convert-to-nnet exp/dnn4_pretrain-dbn/2.rbm - 
LOG (rbm-convert-to-nnet[5.5.810~1-76a979]:main():rbm-convert-to-nnet.cc:69) Written model to -
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn/2.dbn

# PRE-TRAINING RBM LAYER 3
# computing cmvn stats 'exp/dnn4_pretrain-dbn/3.cmvn' for RBM initialization
WARNING (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:228) Not in compute-exclusive mode.  Suggestion: use 'nvidia-smi -c 3' to set compute exclusive mode
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:408) Selecting from 1 GPUs
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:423) cudaSetDevice(0): Tesla K80	free:11372M, used:68M, total:11441M, free/total:0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:471) Device: 0, mem_ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:352) Trying to select device: 0
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:481) Success selecting device 0 free mem ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:FinalizeActiveGpu():cu-device.cc:308) The active GPU is [0]: Tesla K80	free:11262M, used:178M, total:11441M, free/total:0.984377 version 3.7
nnet-concat exp/dnn4_pretrain-dbn/final.feature_transform exp/dnn4_pretrain-dbn/2.dbn - 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/final.feature_transform
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn/2.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to -
copy-feats scp:exp/dnn4_pretrain-dbn/train.scp.10k ark:- 
LOG (copy-feats[5.5.810~1-76a979]:main():copy-feats.cc:143) Copied 3696 feature matrices.
LOG (nnet-forward[5.5.810~1-76a979]:main():nnet-forward.cc:192) Done 3696 files in 0.33876min, (fps 55340.2)
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:168) Wrote global CMVN stats to standard output
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:171) Done accumulating CMVN stats for 3696 utterances; 0 had errors.
LOG (cmvn-to-nnet[5.5.810~1-76a979]:main():cmvn-to-nnet.cc:114) Written cmvn in 'nnet1' model to: exp/dnn4_pretrain-dbn/3.cmvn
initializing 'exp/dnn4_pretrain-dbn/3.rbm.init'
pretraining 'exp/dnn4_pretrain-dbn/3.rbm' (lrate 0.4, iters 20)
# appending RBM to exp/dnn4_pretrain-dbn/3.dbn
nnet-concat exp/dnn4_pretrain-dbn/2.dbn 'rbm-convert-to-nnet exp/dnn4_pretrain-dbn/3.rbm - |' exp/dnn4_pretrain-dbn/3.dbn 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/2.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating rbm-convert-to-nnet exp/dnn4_pretrain-dbn/3.rbm - |
rbm-convert-to-nnet exp/dnn4_pretrain-dbn/3.rbm - 
LOG (rbm-convert-to-nnet[5.5.810~1-76a979]:main():rbm-convert-to-nnet.cc:69) Written model to -
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn/3.dbn

# PRE-TRAINING RBM LAYER 4
# computing cmvn stats 'exp/dnn4_pretrain-dbn/4.cmvn' for RBM initialization
WARNING (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:228) Not in compute-exclusive mode.  Suggestion: use 'nvidia-smi -c 3' to set compute exclusive mode
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:408) Selecting from 1 GPUs
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:423) cudaSetDevice(0): Tesla K80	free:11372M, used:68M, total:11441M, free/total:0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:471) Device: 0, mem_ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:352) Trying to select device: 0
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:481) Success selecting device 0 free mem ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:FinalizeActiveGpu():cu-device.cc:308) The active GPU is [0]: Tesla K80	free:11262M, used:178M, total:11441M, free/total:0.984377 version 3.7
nnet-concat exp/dnn4_pretrain-dbn/final.feature_transform exp/dnn4_pretrain-dbn/3.dbn - 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/final.feature_transform
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn/3.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to -
copy-feats scp:exp/dnn4_pretrain-dbn/train.scp.10k ark:- 
LOG (copy-feats[5.5.810~1-76a979]:main():copy-feats.cc:143) Copied 3696 feature matrices.
LOG (nnet-forward[5.5.810~1-76a979]:main():nnet-forward.cc:192) Done 3696 files in 0.392454min, (fps 47768.8)
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:168) Wrote global CMVN stats to standard output
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:171) Done accumulating CMVN stats for 3696 utterances; 0 had errors.
LOG (cmvn-to-nnet[5.5.810~1-76a979]:main():cmvn-to-nnet.cc:114) Written cmvn in 'nnet1' model to: exp/dnn4_pretrain-dbn/4.cmvn
initializing 'exp/dnn4_pretrain-dbn/4.rbm.init'
pretraining 'exp/dnn4_pretrain-dbn/4.rbm' (lrate 0.4, iters 20)
# appending RBM to exp/dnn4_pretrain-dbn/4.dbn
nnet-concat exp/dnn4_pretrain-dbn/3.dbn 'rbm-convert-to-nnet exp/dnn4_pretrain-dbn/4.rbm - |' exp/dnn4_pretrain-dbn/4.dbn 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/3.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating rbm-convert-to-nnet exp/dnn4_pretrain-dbn/4.rbm - |
rbm-convert-to-nnet exp/dnn4_pretrain-dbn/4.rbm - 
LOG (rbm-convert-to-nnet[5.5.810~1-76a979]:main():rbm-convert-to-nnet.cc:69) Written model to -
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn/4.dbn

# PRE-TRAINING RBM LAYER 5
# computing cmvn stats 'exp/dnn4_pretrain-dbn/5.cmvn' for RBM initialization
WARNING (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:228) Not in compute-exclusive mode.  Suggestion: use 'nvidia-smi -c 3' to set compute exclusive mode
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:408) Selecting from 1 GPUs
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:423) cudaSetDevice(0): Tesla K80	free:11372M, used:68M, total:11441M, free/total:0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:471) Device: 0, mem_ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:352) Trying to select device: 0
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:481) Success selecting device 0 free mem ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:FinalizeActiveGpu():cu-device.cc:308) The active GPU is [0]: Tesla K80	free:11262M, used:178M, total:11441M, free/total:0.984377 version 3.7
nnet-concat exp/dnn4_pretrain-dbn/final.feature_transform exp/dnn4_pretrain-dbn/4.dbn - 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/final.feature_transform
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn/4.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to -
copy-feats scp:exp/dnn4_pretrain-dbn/train.scp.10k ark:- 
LOG (copy-feats[5.5.810~1-76a979]:main():copy-feats.cc:143) Copied 3696 feature matrices.
LOG (nnet-forward[5.5.810~1-76a979]:main():nnet-forward.cc:192) Done 3696 files in 0.441646min, (fps 42448.1)
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:168) Wrote global CMVN stats to standard output
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:171) Done accumulating CMVN stats for 3696 utterances; 0 had errors.
LOG (cmvn-to-nnet[5.5.810~1-76a979]:main():cmvn-to-nnet.cc:114) Written cmvn in 'nnet1' model to: exp/dnn4_pretrain-dbn/5.cmvn
initializing 'exp/dnn4_pretrain-dbn/5.rbm.init'
pretraining 'exp/dnn4_pretrain-dbn/5.rbm' (lrate 0.4, iters 20)
# appending RBM to exp/dnn4_pretrain-dbn/5.dbn
nnet-concat exp/dnn4_pretrain-dbn/4.dbn 'rbm-convert-to-nnet exp/dnn4_pretrain-dbn/5.rbm - |' exp/dnn4_pretrain-dbn/5.dbn 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/4.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating rbm-convert-to-nnet exp/dnn4_pretrain-dbn/5.rbm - |
rbm-convert-to-nnet exp/dnn4_pretrain-dbn/5.rbm - 
LOG (rbm-convert-to-nnet[5.5.810~1-76a979]:main():rbm-convert-to-nnet.cc:69) Written model to -
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn/5.dbn

# PRE-TRAINING RBM LAYER 6
# computing cmvn stats 'exp/dnn4_pretrain-dbn/6.cmvn' for RBM initialization
WARNING (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:228) Not in compute-exclusive mode.  Suggestion: use 'nvidia-smi -c 3' to set compute exclusive mode
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:408) Selecting from 1 GPUs
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:423) cudaSetDevice(0): Tesla K80	free:11372M, used:68M, total:11441M, free/total:0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:471) Device: 0, mem_ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuId():cu-device.cc:352) Trying to select device: 0
LOG (nnet-forward[5.5.810~1-76a979]:SelectGpuIdAuto():cu-device.cc:481) Success selecting device 0 free mem ratio: 0.993991
LOG (nnet-forward[5.5.810~1-76a979]:FinalizeActiveGpu():cu-device.cc:308) The active GPU is [0]: Tesla K80	free:11262M, used:178M, total:11441M, free/total:0.984377 version 3.7
nnet-concat exp/dnn4_pretrain-dbn/final.feature_transform exp/dnn4_pretrain-dbn/5.dbn - 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/final.feature_transform
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating exp/dnn4_pretrain-dbn/5.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to -
copy-feats scp:exp/dnn4_pretrain-dbn/train.scp.10k ark:- 
LOG (copy-feats[5.5.810~1-76a979]:main():copy-feats.cc:143) Copied 3696 feature matrices.
LOG (nnet-forward[5.5.810~1-76a979]:main():nnet-forward.cc:192) Done 3696 files in 0.466907min, (fps 40151.6)
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:168) Wrote global CMVN stats to standard output
LOG (compute-cmvn-stats[5.5.810~1-76a979]:main():compute-cmvn-stats.cc:171) Done accumulating CMVN stats for 3696 utterances; 0 had errors.
LOG (cmvn-to-nnet[5.5.810~1-76a979]:main():cmvn-to-nnet.cc:114) Written cmvn in 'nnet1' model to: exp/dnn4_pretrain-dbn/6.cmvn
initializing 'exp/dnn4_pretrain-dbn/6.rbm.init'
pretraining 'exp/dnn4_pretrain-dbn/6.rbm' (lrate 0.4, iters 20)
# appending RBM to exp/dnn4_pretrain-dbn/6.dbn
nnet-concat exp/dnn4_pretrain-dbn/5.dbn 'rbm-convert-to-nnet exp/dnn4_pretrain-dbn/6.rbm - |' exp/dnn4_pretrain-dbn/6.dbn 
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:53) Reading exp/dnn4_pretrain-dbn/5.dbn
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:65) Concatenating rbm-convert-to-nnet exp/dnn4_pretrain-dbn/6.rbm - |
rbm-convert-to-nnet exp/dnn4_pretrain-dbn/6.rbm - 
LOG (rbm-convert-to-nnet[5.5.810~1-76a979]:main():rbm-convert-to-nnet.cc:69) Written model to -
LOG (nnet-concat[5.5.810~1-76a979]:main():nnet-concat.cc:82) Written model to exp/dnn4_pretrain-dbn/6.dbn

# REPORT
# RBM pre-training progress (line per-layer)
exp/dnn4_pretrain-dbn/log/rbm.1.log:progress: [59.5636 53.3483 52.1445 51.4957 51.1503 50.9368 50.7863 50.6796 50.5905 50.5294 50.4668 50.4232 50.4326 50.432 50.4334 50.4364 50.4359 50.4326 50.417 50.4078 50.4175 50.414 50.4 50.3934 ]
exp/dnn4_pretrain-dbn/log/rbm.2.log:progress: [6.6951 5.54862 5.45298 5.39233 5.34116 5.29278 5.2435 5.20037 5.15594 5.11488 5.07461 5.04797 ]
exp/dnn4_pretrain-dbn/log/rbm.3.log:progress: [5.93085 4.563 4.47966 4.43811 4.40348 4.37114 4.33919 4.31118 4.28018 4.2527 4.22689 4.20836 ]
exp/dnn4_pretrain-dbn/log/rbm.4.log:progress: [4.37745 3.54894 3.484 3.45162 3.42927 3.40787 3.387 3.36801 3.3493 3.33351 3.31813 3.3085 ]
exp/dnn4_pretrain-dbn/log/rbm.5.log:progress: [4.10698 3.11669 3.05802 3.03479 3.01724 3.00145 2.98602 2.97326 2.95954 2.94803 2.93473 2.92824 ]
exp/dnn4_pretrain-dbn/log/rbm.6.log:progress: [3.22486 2.53888 2.48775 2.46957 2.45628 2.44366 2.4329 2.42143 2.41215 2.40352 2.39456 2.38962 ]

Pre-training finished.
# Removing features tmpdir /tmp/kaldi.b1S4 @ vgnd012
train.ark
# Accounting: time=7553 threads=1
# Finished at Tue Oct 20 12:27:58 CEST 2020 with status 0
